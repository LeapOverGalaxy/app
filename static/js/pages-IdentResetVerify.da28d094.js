(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-IdentResetVerify"],{2653:function(e,t,s){"use strict";s.r(t);var a=s("7b0b"),n=s("958a");for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);s("ae56");var o,d=s("f0c5"),c=Object(d["a"])(n["default"],a["b"],a["c"],!1,null,"130484ec",null,!1,a["a"],o);t["default"]=c.exports},"7b0b":function(e,t,s){"use strict";var a,n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-uni-view",{staticClass:"sPage"},[s("v-uni-view",{staticClass:"sLogo"}),s("v-uni-view",{staticClass:"sForm"},[s("v-uni-view",{staticClass:"sInputField"},[s("v-uni-text",{staticClass:"sLabel"},[e._v(e._s(e.localeText.tPhoneLabel))]),s("v-uni-text",{staticClass:"sPhoneInput",class:{sErrorPrompt:!e._SS.Ident.phone}},[e._v(e._s(e._SS.Ident.phone||e.localeText.tEmptyPhone))])],1),s("v-uni-view",{staticClass:"sInputField"},[s("v-uni-text",{staticClass:"sLabel"},[e._v(e._s(e.localeText.tPasscodeLabel))]),s("v-uni-view",{staticClass:"sValue"},[s("v-uni-input",{staticClass:"sPasscodeInput",attrs:{type:"number",maxlength:"6",placeholder:e.passcodePrompt,"placeholder-class":e.passcodeFeedback?"sErrorPrompt":""},model:{value:e._SS.Ident.passcode,callback:function(t){e.$set(e._SS.Ident,"passcode",t)},expression:"_SS.Ident.passcode"}}),s("v-uni-button",{staticClass:"sPasscodeButton",attrs:{loading:e.isSending,disabled:e.isSendingDisabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getPasscode.apply(void 0,arguments)}}},[e._v(e._s((e.remainingSeconds?"("+e.remainingSeconds+") ":"")+e.localeText.tPasscodeButton))])],1)],1)],1),s("v-uni-view",{staticClass:"sFooterFloating"},[s("v-uni-button",{staticClass:"sSubmitButton",attrs:{loading:e.isLoading,disabled:e.isLoading},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.verifyPasscode.apply(void 0,arguments)}}},[e._v(e._s(e.localeText.tVerifyButton))]),s("v-uni-text",{staticClass:"sSubmitFeedback",class:{sActive:e.submitFeedback}},[e._v(e._s(e.submitFeedback))])],1)],1)},i=[];s.d(t,"b",function(){return n}),s.d(t,"c",function(){return i}),s.d(t,"a",function(){return a})},"958a":function(e,t,s){"use strict";s.r(t);var a=s("fa8f"),n=s.n(a);for(var i in a)"default"!==i&&function(e){s.d(t,e,function(){return a[e]})}(i);t["default"]=n.a},ae56:function(e,t,s){"use strict";var a=s("de53"),n=s.n(a);n.a},de53:function(e,t,s){var a=s("eec7");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=s("4f06").default;n("5602e46f",a,!0,{sourceMap:!1,shadowMode:!1})},eec7:function(e,t,s){var a=s("b041");t=e.exports=s("2350")(!1),t.push([e.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/******* LOG 私有定义 ************/.sPage[data-v-130484ec]{background-image:url('+a(s("6984"))+")}.sPage .sForm[data-v-130484ec]{padding:%?15?%\n\n}@media screen and (min-width:751px){.sPage .sForm[data-v-130484ec]{padding:2%}}.sPage .sForm .sInputField[data-v-130484ec]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;padding:%?15?%;border-bottom:1px solid #eee;color:#fff;margin:%?40?% auto\n\n}@media screen and (min-width:751px){.sPage .sForm .sInputField[data-v-130484ec]{margin:40px auto}}.sPage .sForm .sInputField .sLabel[data-v-130484ec]{width:25%;font-size:%?36?%\n\n}@media screen and (min-width:751px){.sPage .sForm .sInputField .sLabel[data-v-130484ec]{font-size:36px}}.sPage .sForm .sInputField .sPhoneInput[data-v-130484ec]{width:75%;font-size:%?36?%;letter-spacing:%?10?%\n\n}@media screen and (min-width:751px){.sPage .sForm .sInputField .sPhoneInput[data-v-130484ec]{font-size:36px}}.sPage .sForm .sInputField .sValue[data-v-130484ec]{width:75%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.sPage .sForm .sInputField .sPasscodeInput[data-v-130484ec]{font-size:%?36?%;letter-spacing:%?10?%;-webkit-box-flex:1;-webkit-flex:auto;flex:auto\n\n}@media screen and (min-width:751px){.sPage .sForm .sInputField .sPasscodeInput[data-v-130484ec]{font-size:36px}}.sPage .sForm .sInputField .sPasscodeButton[data-v-130484ec]{height:%?52?%;line-height:%?52?%;background:#fc962b;color:#000;font-size:small;margin:0;padding:0 %?15?%;-webkit-box-flex:0;-webkit-flex:none;flex:none\n\n}@media screen and (min-width:751px){.sPage .sForm .sInputField .sPasscodeButton[data-v-130484ec]{height:52px;line-height:52px;padding:0 15px}}.sPage .sForm .sInputField .sErrorPrompt[data-v-130484ec]{color:#fc4e2b;letter-spacing:unset}.sPage .sSubmitFeedback[data-v-130484ec]{font-size:small;color:#fc4e2b;-webkit-transition:all 1s ease-in-out 0s;transition:all 1s ease-in-out 0s;opacity:0;margin:%?20?% auto\n\n}@media screen and (min-width:751px){.sPage .sSubmitFeedback[data-v-130484ec]{margin:20px auto}}.sPage .sSubmitFeedback.sActive[data-v-130484ec]{opacity:1}",""])},fa8f:function(e,t,s){"use strict";var a=s("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(s("0a0d")),i=a(s("768b"));s("96cf");var o=a(s("3b8d")),d=a(s("15b8")),c=a(s("84449")),r=60,l={data:function(){return{_SS:this.$store.state,isLoading:!1,isSending:!1,isSendingDisabled:!1,remainingSeconds:0,passcodeHash:"",passcodeExpireAt:"",passcodeFeedback:"",submitFeedback:"",i18nText:(0,d.default)({zhCN:{tPageTitle:"重置密码",tPhoneLabel:"手机号",tPasscodeLabel:"验证码",tPasscodePrompt:"手机短信验证码",tPasscodeButton:"获取",tPasscodeSent:"验证码已成功发送",tPasscodeMalformed:"格式错误，请重新输入",tPasscodeUnsent:"发送失败，请稍后再试",tPasscodeMismatchClient:"验证错误，请重新输入",tPasscodeExpired:"已过期，请重新获取",tPasscodeMismatchServer:"验证失败，请重新获取",tBadResponse:"后台错误，请稍后再试",tVerifyButton:"验 证",tEmptyPhone:"手机号不存在"},enUS:{tPageTitle:"重置密码",tPhoneLabel:"手机号",tPasscodeLabel:"验证码",tPasscodePrompt:"手机短信验证码",tPasscodeButton:"获取",tPasscodeSent:"验证码已成功发送",tPasscodeMalformed:"格式错误，请重新输入",tPasscodeUnsent:"发送失败，请稍后再试",tPasscodeMismatchClient:"验证错误，请重新输入",tPasscodeExpired:"已过期，请重新获取",tPasscodeMismatchServer:"验证失败，请重新获取",tBadResponse:"后台错误，请稍后再试",tVerifyButton:"验 证",tEmptyPhone:"手机号不存在"}})}},computed:{localeText:function(){return this.i18nText[this._SS.i18n.activeLang]},passcodePrompt:function(){return this.passcodeFeedback?(this._SS.Ident.passcode="",this.passcodeFeedback):this.localeText.tPasscodePrompt}},onLoad:function(){this.$store.dispatch("Ident/restartIfOnline")},onShow:function(){uni.setNavigationBarTitle({title:this.$store.getters["i18n/getAppName"]+": "+this.localeText.tPageTitle})},methods:{getPasscode:function(){var e=(0,o.default)(regeneratorRuntime.mark(function e(){var t,s,a,n,o,d=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this._SS.Ident.phone||!this._SS.Ident.uuid){e.next=15;break}return this.isSending=!0,this.isSendingDisabled=!0,e.next=5,this.uni2log.request({url:"api/User/sendPasscode",data:{}});case 5:t=e.sent,s=(0,i.default)(t,2),s[0],a=s[1],this.isSending=!1,this.remainingSeconds=r,n=setInterval(function(){d.remainingSeconds>0?d.remainingSeconds--:(clearInterval(n),d.isSendingDisabled=!1)},1e3),a&&a.data?(o=a.data,a.header,a.statusCode,"PASSCODE_SENT"===o._state?(uni.setStorageSync("_passtoken",o._passtoken),this.passcodeHash=o.passcodeHash,this.passcodeExpireAt=o.passcodeExpireAt,this.passcodeFeedback=this.localeText.tPasscodeSent):"PASSCODE_UNSENT"===o._state?this.passcodeFeedback=this.localeText.tPasscodeUnsent:uni.showToast({image:"../static/Common.fail.png",title:this.localeText.tBadResponse})):uni.showToast({image:"../static/Common.fail.png",title:this.localeText.tBadResponse}),e.next=16;break;case 15:uni.redirectTo({url:"Ident"});case 16:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),validateInput:function(){var e=!0;return/^\d{6}$/.test(this._SS.Ident.passcode)?(0,n.default)()>this.passcodeExpireAt?(this.passcodeFeedback=this.localeText.tPasscodeExpired,this._SS.Ident.passcode="",e=!1):c.default.hash(this._SS.Ident.passcode+this._SS.Ident.uuid)!==this.passcodeHash&&(this.passcodeFeedback=this.localeText.tPasscodeMismatchClient,this._SS.Ident.passcode="",e=!1):(this.passcodeFeedback=this.localeText.tPasscodeMalformed,this._SS.Ident.passcode="",e=!1),e},verifyPasscode:function(){var e=(0,o.default)(regeneratorRuntime.mark(function e(){var t,s,a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.validateInput()){e.next=10;break}return this.isLoading=!0,e.next=4,this.uni2log.request({url:"api/User/verifyPasscode",data:{passcode:this._SS.Ident.passcode}});case 4:t=e.sent,s=(0,i.default)(t,2),s[0],a=s[1],this.isLoading=!1,a&&a.data&&(n=a.data,a.header,a.statusCode,"VERIFY_SUCCESS"===n._state?(uni.setStorageSync("_passtoken",n._passtoken),uni.navigateTo({url:"IdentReset"})):"PASSCODE_EXPIRED"===n._state?(this.passcodeFeedback=this.localeText.tPasscodeExpired,this._SS.Ident.passcode=""):(this.passcodeFeedback=this.localeText.tPasscodeMismatchServer,this._SS.Indent.passcode=""));case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}};t.default=l}}]);